<?xml version="1.0" ?>

<container xmlns="http://symfony.com/schema/dic/services"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://symfony.com/schema/dic/services http://symfony.com/schema/dic/services/services-1.0.xsd">

    <parameters>
        <!-- Classes -->
        <parameter key="sylius.model.file_type.class">Sylius\Bundle\FulfillmentBundle\FileType</parameter>
        <parameter key="sylius.model.fulfillment_provider.class">Sylius\Component\Fulfillment\Model\FulfillmentProviderInterface</parameter>
        <parameter key="sylius.model.order_item_tracking.class">Sylius\Component\Fulfillment\Model\OrderItemTrackingInterface</parameter>
        <parameter key="sylius.model.parameter_type.class">Sylius\Component\Fulfillment\Model\ProtocolInterface</parameter>
        <parameter key="sylius.model.provider_parameter.class">Sylius\Component\Fulfillment\Model\ProviderParameterInterface</parameter>
        <parameter key="sylius.model.fulfillment.class">Sylius\Component\Fulfillment\Model\Fulfillment</parameter>
        <!--<parameter key="sylius.model.interval.class">Sylius\Component\Fulfillment\Model\IntervalInterface</parameter> -->
        <!-- Form parameters -->
        <parameter key="sylius.form.type.fulfillment.class">Sylius\Bundle\FulfillmentBundle\Form\Type\FulfillmentType</parameter>
        <parameter key="sylius.form.type.fulfillment_provider.class">Sylius\Bundle\FulfillmentBundle\Form\Type\FulfillmentProviderType</parameter>
        <parameter key="sylius.form.type.fulfillment_provider_filter.class">Sylius\Bundle\FulfillmentBundle\Form\Type\Filter\FulfillmentProviderFilterType</parameter>
        <parameter key="sylius.form.type.provider_parameter.class">Sylius\Bundle\FulfillmentBundle\Form\Type\ProviderParameterType</parameter>
        <!-- Controllers -->

        <!-- Driver -->
        <parameter key="sylius_fulfillment.driver">doctrine/orm"</parameter>
    </parameters>

    <services>
        <!-- Class services -->
        <service id="sylius_fulfillment.file_type" class="%sylius.model.file_type.class%" />
        <service id="sylius_fulfillment.fulfillment_provider" class="%sylius.model.fulfillment_provider.class%" />
        <service id="sylius_fulfillment.order_item_tracking" class="%sylius.model.order_item_tracking.class%" />
        <service id="sylius_fulfillment.parameter_type" class="%sylius.model.parameter_type.class%" />
        <service id="sylius_fulfillment.provider_parameter" class="%sylius.model.file_type.class%" />
        <service id="sylius_fulfillment.fulfillment" class="%sylius.model.fulfillment.class%">
            <argument type="service" id="sylius.repository.fulfillment" />
            <tag name="form.type" alias="sylius_fulfillment" />
        </service>
        <!-- Form Services -->
        <service id="sylius.form.type.fulfillment" class="%sylius.form.type.fulfillment.class%">
            <argument type="service" id="sylius.repository.fulfillment" />
            <tag name="form.type" alias="sylius_fulfillment" />
        </service>
        <service id="sylius.form.type.fulfillment_provider" class="%sylius.form.type.fulfillment_provider.class%">
            <argument>%sylius.model.fulfillment_provider.class%</argument>
            <tag name="form.type" alias="sylius_fulfillment_provider" />
        </service>
        <service id="sylius.form.type.fulfillment_provider_filter" class="%sylius.form.type.fulfillment_provider_filter.class%">
            <tag name="form.type" alias="sylius_fulfillment_provider_filter" />
        </service>
        <service id="sylius.form.type.provider_parameter" class="%sylius.form.type.provider_parameter.class%">
            <!--<argument type="service" id="sylius.repository.provider_parameter" />-->
            <argument>%sylius.model.provider_parameter.class%</argument>
            <tag name="form.type" alias="sylius_provider_parameter" />
        </service>
        <!-- Sylius Menu Extension Event Handler -->
        <service id="sylius_fulfillment.menu_builder" class="Sylius\Bundle\FulfillmentBundle\EventListener\MenuBuilderListener">
            <tag name="kernel.event_listener" event="sylius.menu_builder.backend.sidebar" method="addBackendMenuItems" />
        </service>
        <!-- Jobs -->
        <service id="sylius_fulfillment.fulfillment_job" class="Sylius\Bundle\FulfillmentBundle\Service\FulfillmentJobService">
            <argument type="service" id="service_container" />
        </service>
        <!-- Writers --> <!-- NOTE: This should be moved to a more generic bundle (like CoreBundle) at some point in the future -->
        <service id="ddeboer_data_import.csv_writer" class="Ddeboer\DataImport\Writer\DoctrineWriter">
            <argument type="service" id="doctrine.orm.entity_manager" />
        </service>
        <service id="ddeboer_data_import.writer.doctrine"
                 class="Ddeboer\DataImport\Writer\DoctrineWriter"
                 abstract="true">
            <argument type="service" id="doctrine.orm.entity_manager" />
        </service>
    </services>

</container>
